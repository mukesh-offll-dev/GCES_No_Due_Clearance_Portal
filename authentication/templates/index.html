{% extends "base.html" %}

{% block content %}
<!-- TITLE -->
<div class="text-center mt-6">
    <h2 class="text-red-700 text-3xl font-bold">Student No Dues Clearance Portal</h2>
    <p class="mt-3 text-lg">
        â€¢ Welcome to the Online No Dues Clearance System, designed to make the student clearance process simple, fast, and paper-free.
    </p>
</div>

<!-- MAIN CONTAINER -->
<div class="flex flex-col md:flex-row justify-center items-start gap-10 mt-12 px-4">

    <!-- ================= Institution Login ================= -->
    <div class="border-4 border-red-600 rounded-3xl p-8 w-full max-w-md">
        <h3 class="text-center text-red-700 text-2xl font-bold mb-6">Institution Login</h3>

        <form method="POST">
            {% csrf_token %}

            <!-- Office -->
            <label class="block mb-2 font-medium">Select Office</label>
            <select name="office" id="office"
                class="w-full border rounded-full px-4 py-2 mb-4"
                onchange="toggleDepartment()">
                <option value="">Select office</option>
                <option value="library">Library Office</option>
                <option value="college">College Office</option>
                <option value="hostel">Hostel Office</option>
                <option value="faculty">Faculty Advisor</option>
                <option value="department">Department</option>
            </select>

            <!-- Department (Only for Department login) -->
            <div id="departmentDiv" class="hidden">
                <label class="block mb-2 font-medium">Select Department</label>
                <select name="department"
                    class="w-full border rounded-full px-4 py-2 mb-4">
                    <option value="">Select department</option>
                    <option value="CSE">CSE</option>
                    <option value="ECE">ECE</option>
                    <option value="EEE">EEE</option>
                    <option value="CIVIL">CIVIL</option>
                    <option value="MECH">MECH</option>
                    <option value="MCT">MCT</option>
                </select>
            </div>

            <!-- Username -->
            <label class="block mb-2 font-medium">Username</label>
            <input type="text" name="username"
                placeholder="Enter username"
                class="w-full border rounded-full px-4 py-2 mb-4">

            <!-- Password -->
            <label class="block mb-2 font-medium">Password</label>
            <input type="password" name="password"
                placeholder="Enter password"
                class="w-full border rounded-full px-4 py-2 mb-6">

            <!-- Error -->
            {% if messages %}
                {% for message in messages %}
                    <p class="text-red-600 text-center mb-3">{{ message }}</p>
                {% endfor %}
            {% endif %}

            <!-- Button -->
            <button type="submit"
                class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-3 rounded-full">
                Login
            </button>
        </form>
    </div>

    <!-- ================= Student Login ================= -->
    <div class="border-4 border-red-600 rounded-3xl p-8 w-full max-w-md">
        <h3 class="text-center text-red-700 text-2xl font-bold mb-6">Student Login</h3>

        <form method="POST" action="{% url 'student_login' %}">
  {% csrf_token %}

  <label class="block mb-2 font-medium">Student Register Number</label>
  <input type="text" name="reg_no" maxlength="12"
    placeholder="Register Number"
    class="w-full border rounded-full px-4 py-2 mb-4">

  <label class="block mb-2 font-medium">Date of Birth</label>
  <input type="date" name="dob"
    class="w-full border rounded-full px-4 py-2 mb-6">

  <button type="submit"
    class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-3 rounded-full">
    Login
  </button>
</form>
{% if request.session.student_error %}
<p id="studentError"
   class="text-red-600 font-semibold text-center mt-3">
  {{ request.session.student_error }}
</p>
{% endif %}

    </div>

</div>

<!-- SCRIPT -->
<script>
function toggleDepartment() {
    const office = document.getElementById("office").value;
    const deptDiv = document.getElementById("departmentDiv");
    deptDiv.classList.toggle("hidden", office !== "department");
}

window.onload = () => {
  const err = document.getElementById("studentError");
  if (err) {
    setTimeout(() => err.style.display = "none", 3000);
  }
}
</script>
{% endblock %}

 